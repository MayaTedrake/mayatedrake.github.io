<!DOCTYPE html>
<html lang="en-US" style="background-color:white; margin:0; min-height:100vh;">
<head>
    <title>Tic Tac Toe</title>
    <link href='https://fonts.googleapis.com/css?family=Bubblegum Sans' rel='stylesheet'>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: min(22px, 4vw);
            background-color: white;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, min(100px, 20vw));
            gap: 2px;
            background-color: black;
            padding: 2px;
            width: fit-content;
            margin: 20px auto;
        }
        .cell {
            background-color: white;
            height: min(100px, 20vw);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: min(40px, 8vw);
            cursor: pointer;
        }
        #turn-display {
            text-align: center;
            margin: 10px auto;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            width: min(304px, 60vw);
        }
        .mode-button {
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .mode-button.active {
            background-color: #e0e0e0;
            border: 2px solid black;
        }
        .mode-button.inactive {
            background-color: white;
            border: 2px solid black;
        }
        #playAgainBtn {
            border: none;
            background-color: #f0f0f0;
        }
        #playAgainBtn:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>


    <div style="display: flex; justify-content: center; align-items: flex-start; gap: min(50px, 5vw); margin-top: min(100px, 15vh); flex-wrap: wrap;">
        <div style="text-align: center;">
            <div id="tictactoe" class="grid">
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
                <div class="cell"></div>
            </div>
            <div id="turn-display">
                <script>
                    window.onload = function() {
                        const cells = document.querySelectorAll('.cell');
                        const turnDisplay = document.getElementById('turn-display');
                        let isSinglePlayer = true;
                        let isPlayerOneTurn = true;
                        
                        // Get mode buttons
                        const singlePlayerBtn = document.getElementById('singlePlayerBtn');
                        const twoPlayerBtn = document.getElementById('twoPlayerBtn');
                        const playAgainBtn = document.getElementById('playAgainBtn');

                        function resetGame() {
                            cells.forEach(cell => {
                                cell.textContent = '';
                            });
                            isPlayerOneTurn = true;
                            if (isSinglePlayer) {
                                const firstPlayer = Math.random() < 0.5 ? 'You' : 'Computer';
                                turnDisplay.textContent = firstPlayer === 'Computer' ? 
                                    "Computer starts first!" : "Your turn!";
                                
                                if (firstPlayer === 'Computer') {
                                    setTimeout(() => {
                                        const randomCell = Math.floor(Math.random() * 9);
                                        cells[randomCell].textContent = 'X';
                                        turnDisplay.textContent = "Your turn!";
                                    }, 1000);
                                }
                            } else {
                                turnDisplay.textContent = "Player One's turn!";
                            }
                        }

                        // Mode switching handlers
                        singlePlayerBtn.addEventListener('click', () => {
                            if (!isSinglePlayer) {
                                isSinglePlayer = true;
                                singlePlayerBtn.classList.add('active');
                                singlePlayerBtn.classList.remove('inactive');
                                twoPlayerBtn.classList.add('inactive');
                                twoPlayerBtn.classList.remove('active');
                                resetGame();
                            }
                        });

                        twoPlayerBtn.addEventListener('click', () => {
                            if (isSinglePlayer) {
                                isSinglePlayer = false;
                                twoPlayerBtn.classList.add('active');
                                twoPlayerBtn.classList.remove('inactive');
                                singlePlayerBtn.classList.add('inactive');
                                singlePlayerBtn.classList.remove('active');
                                resetGame();
                            }
                        });

                        // Play Again handler
                        playAgainBtn.addEventListener('click', resetGame);

                        function checkWin(symbol) {
                            const lines = [
                                [0,1,2], [3,4,5], [6,7,8], // Rows
                                [0,3,6], [1,4,7], [2,5,8], // Columns
                                [0,4,8], [2,4,6] // Diagonals
                            ];
                            
                            for (let line of lines) {
                                const values = line.map(i => cells[i].textContent);
                                if (values.every(v => v === symbol)) {
                                    return true;
                                }
                            }
                            return false;
                        }

                        function checkTie() {
                            return Array.from(cells).every(cell => cell.textContent !== '');
                        }

                        function checkWinningMove(symbol) {
                            const lines = [
                                [0,1,2], [3,4,5], [6,7,8], // Rows
                                [0,3,6], [1,4,7], [2,5,8], // Columns
                                [0,4,8], [2,4,6] // Diagonals
                            ];
                            
                            for (let line of lines) {
                                const values = line.map(i => cells[i].textContent);
                                const emptyIndex = line[values.indexOf('')];
                                if (values.filter(v => v === symbol).length === 2 && values.includes('')) {
                                    return emptyIndex;
                                }
                            }
                            return -1;
                        }

                        function computerMove() {
                            let moveIndex = checkWinningMove('X');
                            
                            if (moveIndex === -1) {
                                moveIndex = checkWinningMove('O');
                            }
                            
                            if (moveIndex === -1) {
                                const emptyCells = Array.from(cells).filter(c => !c.textContent);
                                if (emptyCells.length > 0) {
                                    const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                                    moveIndex = Array.from(cells).indexOf(randomCell);
                                }
                            }
                            
                            return moveIndex;
                        }

                        // Initialize single player mode as active
                        singlePlayerBtn.classList.add('active');
                        twoPlayerBtn.classList.add('inactive');
                        resetGame();

                        cells.forEach(cell => {
                            cell.addEventListener('click', () => {
                                if (isSinglePlayer) {
                                    // Single player mode
                                    if (turnDisplay.textContent === "Your turn!" && !cell.textContent) {
                                        cell.textContent = 'O';
                                        
                                        if (checkWin('O')) {
                                            turnDisplay.textContent = "ðŸŽ‰ðŸŽ‰ðŸŽ‰ You won! ðŸŽ‰ðŸŽ‰ðŸŽ‰";
                                            return;
                                        }
                                        
                                        if (checkTie()) {
                                            turnDisplay.textContent = "ðŸŸ°ðŸŸ°ðŸŸ° Tie! ðŸŸ°ðŸŸ°ðŸŸ°";
                                            return;
                                        }

                                        turnDisplay.textContent = "Computer's turn!";
                                        
                                        setTimeout(() => {
                                            const moveIndex = computerMove();
                                            if (moveIndex !== -1) {
                                                cells[moveIndex].textContent = 'X';
                                                
                                                if (checkWin('X')) {
                                                    turnDisplay.textContent = "ðŸ˜­ðŸ˜­ðŸ˜­ Computer won! ðŸ˜­ðŸ˜­ðŸ˜­";
                                                    return;
                                                }
                                                
                                                if (checkTie()) {
                                                    turnDisplay.textContent = "Tie!";
                                                    return;
                                                }

                                                turnDisplay.textContent = "Your turn!";
                                            }
                                        }, 1000);
                                    }
                                } else {
                                    // Two player mode
                                    if (!cell.textContent) {
                                        cell.textContent = isPlayerOneTurn ? 'O' : 'X';
                                        
                                        if (checkWin(isPlayerOneTurn ? 'O' : 'X')) {
                                            turnDisplay.textContent = `${isPlayerOneTurn ? 'Player One' : 'Player Two'} won!`;
                                            return;
                                        }
                                        
                                        if (checkTie()) {
                                            turnDisplay.textContent = "Tie!";
                                            return;
                                        }

                                        isPlayerOneTurn = !isPlayerOneTurn;
                                        turnDisplay.textContent = `${isPlayerOneTurn ? 'Player One' : 'Player Two'}'s turn!`;
                                    }
                                }
                            });
                        });
                    }
                </script>
            </div>
        </div>

        <div style="background-color: #f0f0f0; padding: 20px; border-radius: 10px; width: min(300px, 80vw);">
            <h2 style="margin-top: 0; font-size: 16px; text-align: center;">Instructions:</h2>
            <div style="font-size: 14px; text-align: center;">
                Single Player: Choose a square when it says "Your turn!". Try to get three O's in a row!
                <br><br>
                Two Players: Decide who will be player one and player two. Take turns when prompted. Try to get three of your symbol in a row!
            </div>
        </div>
    </div>

    <div style="text-align: center; margin-top: 20px;">
        <button id="singlePlayerBtn" class="mode-button">Single Player</button>
        <button id="twoPlayerBtn" class="mode-button">Two Players</button>
        <br>
        <button id="playAgainBtn" class="mode-button" style="margin-top: 10px;">Play Again</button>
    </div>

</body>
</html>
